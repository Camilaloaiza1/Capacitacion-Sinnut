<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abonar y Facturar Plan Separe - Curso Sinnut ERP</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        :root {
            /* Color Palette Institucional */
            --primary-color: #0D2339;
            --primary-light: #1a3b5c;
            --primary-dark: #051119;
            --accent-color: #c59d5f;
            --accent-light: #d4af7a;
            
            /* Semantic Colors */
            --success-color: #22c55e;
            --success-light: #4ade80;
            --warning-color: #f59e0b;
            --warning-light: #fbbf24;
            --danger-color: #ef4444;
            --danger-light: #f87171;
            --info-color: #3b82f6;
            --info-light: #60a5fa;
            
            /* Neutrals */
            --neutral-50: #f8fafc;
            --neutral-100: #f1f5f9;
            --neutral-200: #e2e8f0;
            --neutral-300: #cbd5e1;
            --neutral-400: #94a3b8;
            --neutral-500: #64748b;
            --neutral-600: #475569;
            --neutral-700: #334155;
            --neutral-800: #1e293b;
            --neutral-900: #0f172a;
            
            /* Text Colors */
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-muted: #94a3b8;
            --text-inverse: #ffffff;
            
            /* Spacing System */
            --spacing-xs: 0.25rem;     /* 4px */
            --spacing-sm: 0.5rem;      /* 8px */
            --spacing-md: 0.75rem;     /* 12px */
            --spacing-lg: 1rem;        /* 16px */
            --spacing-xl: 1.5rem;      /* 24px */
            --spacing-2xl: 2rem;       /* 32px */
            --spacing-3xl: 2.5rem;     /* 40px */
            --spacing-4xl: 3rem;       /* 48px */
            --spacing-5xl: 4rem;       /* 64px */
            --spacing-6xl: 5rem;       /* 80px */
            --spacing-8: 2rem;         /* 32px - Alias */
            --spacing-12: 3rem;        /* 48px - Alias */
            
            /* Border Radius */
            --radius-none: 0;
            --radius-sm: 0.125rem;     /* 2px */
            --radius-md: 0.375rem;     /* 6px */
            --radius-lg: 0.5rem;       /* 8px */
            --radius-xl: 0.75rem;      /* 12px */
            --radius-2xl: 1rem;        /* 16px */
            --radius-3xl: 1.5rem;      /* 24px */
            --radius-full: 9999px;
            
            /* Shadows */
            --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            --shadow-inner: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);
            
            /* Typography */
            --font-size-xs: 0.75rem;    /* 12px */
            --font-size-sm: 0.875rem;   /* 14px */
            --font-size-base: 1rem;     /* 16px */
            --font-size-lg: 1.125rem;   /* 18px */
            --font-size-xl: 1.25rem;    /* 20px */
            --font-size-2xl: 1.5rem;    /* 24px */
            --font-size-3xl: 1.875rem;  /* 30px */
            --font-size-4xl: 2.25rem;   /* 36px */
            --font-size-5xl: 3rem;      /* 48px */
            --font-size-6xl: 3.75rem;   /* 60px */
            
            --font-weight-light: 300;
            --font-weight-normal: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 600;
            --font-weight-bold: 700;
            --font-weight-extrabold: 800;
            
            --line-height-tight: 1.25;
            --line-height-snug: 1.375;
            --line-height-normal: 1.5;
            --line-height-relaxed: 1.625;
            --line-height-loose: 2;
            
            /* Transitions */
            --transition-fast: 150ms ease;
            --transition-base: 200ms ease;
            --transition-slow: 300ms ease;
            --transition-slower: 500ms ease;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Z-Index Scale */
            --z-dropdown: 1000;
            --z-sticky: 1020;
            --z-fixed: 1030;
            --z-modal-backdrop: 1040;
            --z-modal: 1050;
            --z-popover: 1060;
            --z-tooltip: 1070;
        }

        /* CSS Reset y Base */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            line-height: var(--line-height-normal);
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-normal);
            line-height: var(--line-height-relaxed);
            color: var(--text-primary);
            background-color: var(--neutral-50);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
        }

        /* Layout Container */
        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: var(--spacing-lg);
        }

        /* Header Moderno */
        .header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
            color: var(--text-inverse);
            padding: var(--spacing-5xl) var(--spacing-2xl);
            border-radius: var(--radius-3xl);
            text-align: center;
            margin-bottom: var(--spacing-4xl);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-2xl);
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            height: 200%;
            animation: headerShimmer 4s ease-in-out infinite;
        }
        @keyframes headerShimmer {
            50% { transform: translateX(20px) translateY(20px) rotate(180deg); }
        }
        .header-icon {
            margin-bottom: var(--spacing-xl);
            text-shadow: 0 4px 8px rgba(0,0,0,0.3);

            font-size: clamp(1.75rem, 4vw, 2.5rem);
            margin-bottom: var(--spacing-lg);
            line-height: var(--line-height-tight);

            font-size: var(--font-size-lg);
            opacity: 0.95;
            max-width: 700px;
            margin: 0 auto var(--spacing-xl);
            line-height: var(--line-height-relaxed);
        }

        .header-badges {
            display: flex;
            justify-content: center;
            gap: var(--spacing-lg);
            flex-wrap: wrap;
            margin-top: var(--spacing-xl);
        }

        .badge {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: var(--spacing-sm) var(--spacing-lg);
            border-radius: var(--radius-full);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
        }

        .badge:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        /* Navegación Breadcrumb Sticky */
        .nav-breadcrumb {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: var(--spacing-lg);
            border-radius: var(--radius-2xl);
            margin-bottom: var(--spacing-4xl);
            box-shadow: var(--shadow-sm);
            font-size: var(--font-size-sm);
            position: sticky;
            top: var(--spacing-lg);
            z-index: var(--z-sticky);
            border: 1px solid var(--neutral-200);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .nav-breadcrumb.scrolled {
            background: rgba(255, 255, 255, 0.98);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        .nav-breadcrumb a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: var(--font-weight-medium);
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-xs);
        }

        .nav-breadcrumb a:hover {
            color: var(--primary-light);
            transform: translateY(-1px);
        }

        .nav-breadcrumb [aria-current="page"] {
            font-weight: 700;
            color: #0D2339;
        }

        .separator {
            margin: 0 var(--spacing-sm);
            color: var(--neutral-500);
            font-weight: var(--font-weight-normal);
        }

        /* Section Containers */
        .section {
            background: linear-gradient(135deg, white 0%, var(--neutral-50) 100%);
            padding: var(--spacing-4xl);
            border-radius: var(--radius-3xl);
            margin-bottom: var(--spacing-4xl);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--neutral-200);
            position: relative;
            overflow: hidden;
            transition: var(--transition);
        }

        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color), var(--info-color));
            opacity: 0;
            transition: var(--transition);
        }

        .section:hover::before {
            opacity: 1;
        }

        .section:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-2xl);
        }

        .section h2 {
            color: var(--primary-color);
            font-size: var(--font-size-3xl);
            font-weight: var(--font-weight-semibold);
            margin-bottom: var(--spacing-xl);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            line-height: var(--line-height-tight);
        }

        .section h3 {
            color: var(--primary-color);
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-medium);
            margin-bottom: var(--spacing-lg);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        /* Video Container Mejorado */
        .video-container {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            background: linear-gradient(135deg, var(--neutral-100) 0%, var(--neutral-200) 100%);
            border-radius: var(--radius-2xl);
            overflow: hidden;
            box-shadow: var(--shadow-xl);
            margin: var(--spacing-xl) 0;
            border: 3px solid var(--neutral-200);
            transition: var(--transition);
        }

        .video-container:hover {
            border-color: var(--primary-color);
            transform: scale(1.01);
            box-shadow: 0 25px 50px -12px rgba(13, 35, 57, 0.25);
        }

        .video-container video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: var(--radius-lg);
        }

        /* Steps Container */
        .steps-container {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xl);
            margin: var(--spacing-xl) 0;
        }

        .step {
            background: linear-gradient(135deg, white 0%, var(--neutral-50) 100%);
            border: 2px solid var(--neutral-200);
            border-radius: var(--radius-2xl);
            padding: var(--spacing-2xl);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .step::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--success-color), var(--info-color));
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.3s ease;
        }

        .step:hover::before {
            transform: scaleX(1);
        }

        .step:hover {
            border-color: var(--primary-color);
            transform: translateY(-4px) scale(1.01);
            box-shadow: 0 20px 40px 0 rgba(13, 35, 57, 0.15);
            background: linear-gradient(135deg, white 0%, rgba(13, 35, 57, 0.02) 100%);
        }

        .step-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
        }

        .step-number {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
            color: var(--text-inverse);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: var(--font-weight-bold);
            font-size: var(--font-size-xl);
            box-shadow: 0 8px 20px 0 rgba(13, 35, 57, 0.3);
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
        }

        .step-number::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
            animation: stepPulse 3s ease-in-out infinite;
        }

        @keyframes stepPulse {
            0%, 100% { transform: scale(0.8) rotate(0deg); opacity: 0.7; }
            50% { transform: scale(1.2) rotate(180deg); opacity: 1; }
        }

        .step-title {
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-semibold);
            color: var(--primary-color);
            line-height: var(--line-height-tight);
        }

        .step-description {
            color: var(--text-secondary);
            margin-bottom: var(--spacing-lg);
            line-height: var(--line-height-relaxed);
            font-size: var(--font-size-lg);
        }

        /* Alerts Modernos */
        .alert {
            padding: var(--spacing-xl);
            border-radius: var(--radius-2xl);
            margin: var(--spacing-xl) 0;
            display: flex;
            align-items: flex-start;
            gap: var(--spacing-lg);
            border-left: 4px solid;
            backdrop-filter: blur(10px);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            border: 1px solid;
        }

        .alert::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
            animation: alertShine 4s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes alertShine {
            0%, 100% { transform: translateX(-100%); }
            50% { transform: translateX(100%); }
        }

        .alert:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .alert i {
            margin-top: 2px;
            z-index: 1;
            font-size: var(--font-size-xl);
            flex-shrink: 0;
        }

        .alert div {
            z-index: 1;
            flex: 1;
        }

        .alert-info {
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            border-color: var(--info-color);
            color: #1e40af;
        }

        .alert-info i {
            color: var(--info-color);
        }

        .alert-success {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border-color: var(--success-color);
            color: #166534;
        }

        .alert-success i {
            color: var(--success-color);
        }

        .alert-warning {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            border-color: var(--warning-color);
            color: #92400e;
        }

        .alert-warning i {
            color: var(--warning-color);
        }

        .alert-danger {
            background: linear-gradient(135deg, #fef2f2 0%, #fecaca 100%);
            border-color: var(--danger-color);
            color: #991b1b;
        }

        .alert-danger i {
            color: var(--danger-color);
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-lg) var(--spacing-2xl);
            border: none;
            border-radius: var(--radius-2xl);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-semibold);
            text-decoration: none;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            transform-origin: center;
            user-select: none;
            text-align: center;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
            color: var(--text-inverse);
            box-shadow: 0 4px 14px 0 rgba(13, 35, 57, 0.25);
            border: 2px solid transparent;
        }

        .btn-primary:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 25px 0 rgba(13, 35, 57, 0.35);
            background: linear-gradient(135deg, var(--primary-light) 0%, #2a5a7f 100%);
        }

        .btn-primary:active {
            transform: translateY(-1px) scale(0.98);
            transition: all 0.1s ease;
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success-color) 0%, #16a34a 100%);
            color: var(--text-inverse);
            box-shadow: 0 4px 14px 0 rgba(34, 197, 94, 0.25);
            border: 2px solid transparent;
        }

        .btn-success:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 25px 0 rgba(34, 197, 94, 0.35);
            background: linear-gradient(135deg, #16a34a 0%, #15803d 100%);
        }

        .btn-outline {
            background: transparent;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            box-shadow: 0 4px 14px 0 rgba(13, 35, 57, 0.1);
        }

        .btn-outline:hover {
            background: var(--primary-color);
            color: var(--text-inverse);
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 25px 0 rgba(13, 35, 57, 0.25);
        }

        /* CTA Section */
        .cta-section {
            background: linear-gradient(135deg, #e0f2fe 0%, #b3e5fc 100%);
            border: 2px solid var(--info-color);
            border-radius: var(--radius-2xl);
            padding: var(--spacing-4xl);
            text-align: center;
            margin: var(--spacing-4xl) 0;
            position: relative;
            overflow: hidden;
        }

        .cta-section::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(59, 130, 246, 0.1) 0%, transparent 70%);
            animation: ctaPulse 4s ease-in-out infinite;
        }

        @keyframes ctaPulse {
            0%, 100% { transform: scale(0.8) rotate(0deg); opacity: 0.5; }
            50% { transform: scale(1.2) rotate(180deg); opacity: 1; }
        }

        .cta-content {
            position: relative;
            z-index: 2;
        }

        .cta-content h4 {
            color: var(--primary-color);
            font-size: var(--font-size-2xl);
            font-weight: var(--font-weight-semibold);
            margin-bottom: var(--spacing-lg);
        }

        .cta-content p {
            color: var(--text-secondary);
            font-size: var(--font-size-lg);
            margin-bottom: var(--spacing-2xl);
            line-height: var(--line-height-relaxed);
        }

        /* Footer de Navegación del Curso */
        .course-footer {
            background: linear-gradient(135deg, var(--neutral-50) 0%, white 100%);
            border: 2px solid var(--neutral-200);
            border-radius: var(--radius-3xl);
            padding: var(--spacing-4xl);
            margin-top: var(--spacing-5xl);
            box-shadow: var(--shadow-2xl);
            position: relative;
            overflow: hidden;
        }

        .course-footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--success-color), var(--info-color));
        }

        .course-footer-content {
            position: relative;
            z-index: 2;
        }

        .course-footer h3 {
            color: var(--primary-color);
            font-size: var(--font-size-2xl);
            font-weight: var(--font-weight-semibold);
            margin-bottom: var(--spacing-2xl);
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-md);
        }

        .course-navigation {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: var(--spacing-2xl);
            align-items: center;
            margin-bottom: var(--spacing-2xl);
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-lg);
            text-decoration: none;
            transition: var(--transition);
        }

        .nav-item.prev {
            justify-self: start;
        }

        .nav-item.home {
            justify-self: center;
        }

        .nav-item.next {
            justify-self: end;
        }

        .nav-btn {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-lg) var(--spacing-2xl);
            border-radius: var(--radius-2xl);
            background: white;
            color: var(--text-primary);
            text-decoration: none;
            font-weight: var(--font-weight-medium);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            min-width: 160px;
            justify-content: center;
            box-shadow: var(--shadow-sm);
        }

        .nav-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(13, 35, 57, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .nav-btn:hover::before {
            left: 100%;
        }

        .nav-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-xl);
        }

        .nav-btn.prev:hover {
            background: var(--warning-color);
            color: var(--text-inverse);
        }

        .nav-btn.home:hover {
            background: var(--primary-color);
            color: var(--text-inverse);
        }

        .nav-btn.next:hover {
            background: var(--success-color);
            color: var(--text-inverse);
        }

        .nav-info {
            text-align: center;
            color: var(--text-secondary);
            font-size: var(--font-size-sm);
            padding-top: var(--spacing-2xl);
            border-top: 1px solid var(--neutral-200);
            line-height: var(--line-height-relaxed);
        }

        .progress-indicator {
            display: flex;
            justify-content: center;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-2xl);
        }

        .progress-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--neutral-300);
            transition: var(--transition);
            cursor: pointer;
        }

        .progress-dot.completed {
            background: var(--success-color);
            box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.2);
        }

        .progress-dot.current {
            background: var(--primary-color);
            transform: scale(1.3);
            box-shadow: 0 0 0 3px rgba(13, 35, 57, 0.2);
        }

        .progress-dot:hover {
            transform: scale(1.2);
        }

        /* Animaciones de Entrada */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes fadeInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .animate-in {
            animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        .animate-left {
            animation: fadeInLeft 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        .animate-right {
            animation: fadeInRight 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        .animate-scale {
            animation: scaleIn 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: var(--spacing-sm);
            }
            
            .header {
                padding: var(--spacing-3xl) var(--spacing-lg);
            }
            
            .header h1 {
                font-size: var(--font-size-3xl);
            }
            
            .header p {
                font-size: var(--font-size-base);
            }
            
            .header-badges {
                justify-content: center;
                gap: var(--spacing-sm);
            }
            
            .badge {
                padding: var(--spacing-xs) var(--spacing-sm);
                font-size: var(--font-size-xs);
            }
            
            .section {
                padding: var(--spacing-2xl);
            }
            
            .section h2 {
                font-size: var(--font-size-2xl);
            }
            
            .step {
                padding: var(--spacing-xl);
            }
            
            .step-header {
                flex-direction: column;
                text-align: center;
                gap: var(--spacing-md);
            }
            
            .step-number {
                width: 50px;
                height: 50px;
                font-size: var(--font-size-lg);
            }
            
            .btn {
                padding: var(--spacing-sm) var(--spacing-lg);
                font-size: var(--font-size-xs);
            }

            .course-navigation {
                grid-template-columns: 1fr;
                gap: var(--spacing-lg);
                text-align: center;
            }

            .nav-item {
                justify-self: center !important;
            }

            .nav-btn {
                width: 100%;
                min-width: auto;
            }

            .course-footer {
                padding: var(--spacing-2xl);
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: var(--font-size-2xl);
            }
            
            .header-badges {
                flex-direction: column;
                align-items: center;
            }
        }

        /* Video Container Mejorado con Poster y Fallback */
        .responsive-video-wrapper {
            position: relative;
            width: 100%;
            margin: var(--spacing-xl) 0;
        }

        .video-container {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            background: linear-gradient(135deg, var(--neutral-100) 0%, var(--neutral-200) 100%);
            border-radius: var(--radius-2xl);
            overflow: hidden;
            box-shadow: var(--shadow-xl);
            border: 3px solid var(--neutral-200);
            transition: var(--transition);
        }

        .video-container:hover {
            border-color: var(--primary-color);
            transform: scale(1.01);
            box-shadow: 0 25px 50px -12px rgba(13, 35, 57, 0.25);
        }

        .video-container video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: var(--radius-lg);
        }

        /* Poster personalizado del video */
        .video-poster {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
            transition: var(--transition);
            border-radius: var(--radius-lg);
        }

        .video-poster:hover {
            background: linear-gradient(135deg, var(--primary-light) 0%, #2a5a7f 100%);
            transform: scale(1.02);
        }

        .poster-content {
            text-align: center;
            color: var(--text-inverse);
            padding: var(--spacing-2xl);
            max-width: 400px;
        }

        .poster-content i {
            font-size: 4rem;
            margin-bottom: var(--spacing-lg);
            color: var(--accent-color);
            text-shadow: 0 4px 8px rgba(0,0,0,0.3);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .poster-content h4 {
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-semibold);
            margin-bottom: var(--spacing-md);
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .poster-content p {
            font-size: var(--font-size-lg);
            opacity: 0.9;
            margin: 0;
        }

        /* Fallback para errores */
        .video-fallback {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--danger-color) 0%, #dc2626 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 15;
            border-radius: var(--radius-lg);
        }

        .fallback-content {
            text-align: center;
            color: var(--text-inverse);
            padding: var(--spacing-2xl);
            max-width: 400px;
        }

        .fallback-content i {
            font-size: 3rem;
            margin-bottom: var(--spacing-lg);
            color: var(--text-inverse);
        }

        .fallback-content h4 {
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-semibold);
            margin-bottom: var(--spacing-md);
        }

        .fallback-content p {
            font-size: var(--font-size-base);
            opacity: 0.9;
            margin-bottom: var(--spacing-xl);
        }

        .retry-btn {
            background: var(--text-inverse);
            color: var(--danger-color);
            border: none;
            padding: var(--spacing-md) var(--spacing-xl);
            border-radius: var(--radius-xl);
            font-weight: var(--font-weight-semibold);
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .retry-btn:hover {
            background: var(--neutral-200);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        /* Icono de completado */
        .completion-icon {
            font-size: 4rem;
            margin-bottom: var(--spacing-lg);
            color: var(--success-color);
            animation: bounceIn 0.8s ease-out;
        }

        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Navegación Breadcrumb Sticky -->
        <div class="nav-breadcrumb" id="navBreadcrumb">
            <a href="../../index.html"><i class="fas fa-home"></i> Inicio</a>
            <span class="separator">></span>
            <a href="introduccion-facturas.html">Introducción</a>
            <span class="separator">></span>
            <a href="factura-de-venta.html">Factura de Venta</a>
            <span class="separator">></span>
            <a href="crear-plan-separe.html">Crear Plan Separe</a>
            <span class="separator">></span>
            <a href="consultar-plan-separe.html">Consultar Plan Separe</a>
            <span class="separator">></span>
            <span aria-current="page">Abonar/Facturar Plan Separe</span>
            <span class="separator">></span>
            <a href="fin-modulo-facturas.html">Fin Módulo</a>
        </div>

        <!-- Header Moderno -->
        <div class="header animate-in">
            <div class="header-content">
                <div class="header-icon">
                    <i class="fas fa-credit-card"></i>
                </div>
                <h1>Abonar y Facturar Plan Separe</h1>
                <p>Domina el proceso completo de gestión de planes separe: desde registrar abonos parciales hasta generar la factura definitiva cuando el cliente complete el pago total</p>
                
                <div class="header-badges">
                    <div class="badge">
                        <i class="fas fa-clock"></i>
                        2 videos
                    </div>
                    <div class="badge">
                        <i class="fas fa-play-circle"></i>
                        2 minutos
                    </div>
                    <div class="badge">
                        <i class="fas fa-list-ol"></i>
                        5 Pasos
                    </div>
                </div>
            </div>
        </div>

        <!-- Introducción -->
        <section class="section animate-in">
            <h2>
                <i class="fas fa-lightbulb"></i>
                ¿Qué es abonar y facturar un plan separe?
            </h2>
            <p style="font-size: var(--font-size-lg); line-height: var(--line-height-relaxed); margin-bottom: var(--spacing-xl); color: var(--text-secondary);">
                Cuando un cliente ha separado un producto mediante un plan separe, puede realizar abonos parciales hasta completar el valor total. Una vez completado el pago, se puede generar la factura definitiva para formalizar la venta.
            </p>
            
            <div class="alert alert-info">
                <i class="fas fa-info-circle"></i>
                <div>
                    <strong>Proceso dual:</strong> 
                    <p>Primero aprenderás a registrar abonos parciales, y luego cómo convertir el plan separe en una factura definitiva cuando el pago esté completo.</p>
                </div>
            </div>
        </section>

        <!-- Primera Sección: Abonar Plan Separe -->
        <section class="section animate-in">
            <h2>
                <i class="fas fa-piggy-bank"></i>
                Registrar Abonos al Plan Separe
            </h2>
            <p style="margin-bottom: var(--spacing-xl); color: var(--text-secondary); font-size: var(--font-size-lg);">
                Aprende a registrar abonos parciales que el cliente va realizando hasta completar el valor total del producto separado.
            </p>
            
            <div class="alert alert-info">
                <i class="fas fa-stopwatch"></i>
                <div>
                    <strong>Tiempo estimado de operación:</strong>
                    <p>Aproximadamente 30 segundos para registrar cada abono en el sistema.</p>
                </div>
            </div>
            
            <!-- Contenedor responsivo del video -->
            <div class="responsive-video-wrapper">
                <div class="video-container">
                    <!-- Video optimizado para máxima compatibilidad iOS Safari -->
                    <video id="videoPlayer1" 
                           class="video-player"
                           controls
                           preload="metadata"
                           playsinline
                           webkit-playsinline
                           muted
                           disablePictureInPicture>
                        <source src="../../assets/videos/Facturas/abonar-facturar-plan-separe/abono-plan-separe.mp4" type="video/mp4">
                        <p>Tu navegador no soporta la reproducción de video HTML5. 
                           <a href="../../assets/videos/Facturas/abonar-facturar-plan-separe/abono-plan-separe.mp4" target="_blank">
                              Haz clic aquí para descargar el video
                           </a>
                        </p>
                    </video>
                    
                    <!-- Poster de carga personalizado -->
                    <div class="video-poster" id="videoPoster1">
                        <div class="poster-content">
                            <i class="fas fa-play-circle"></i>
                            <h4>Video Tutorial: Registrar Abonos</h4>
                            <p>Toca para reproducir</p>
                        </div>
                    </div>
                </div>
                
                <!-- Fallback para errores (fuera del video) -->
                <div class="video-fallback" id="videoFallback1" style="display: none;">
                    <div class="fallback-content">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h4>Video no disponible</h4>
                        <p>Verifica tu conexión a internet o contacta con soporte técnico.</p>
                        <button class="retry-btn" onclick="VideoHandler.retryLoad(1)">
                            <i class="fas fa-redo"></i> Reintentar
                        </button>
                    </div>
                </div>
            </div>

            <!-- Paso a Paso dentro de la sección del video -->
            <div class="alert alert-info" role="alert" style="margin-top: var(--spacing-xl);">
                <i class="fas fa-list-ol" aria-hidden="true"></i>
                <div>
                    <strong>Paso a Paso - Registrar Abonos al Plan Separe:</strong>
                    <ol style="margin-top: var(--spacing-sm); padding-left: var(--spacing-lg);">
                        <li>En el módulo <strong>Gestión de ventas</strong>, selecciona <strong>Plan Separe</strong> y localiza el plan separe específico usando la secuencia o el documento del cliente</li>
                        <li>Ingresa al plan separe seleccionado y localiza el botón <strong>Abonar</strong> para iniciar el proceso de registro del pago parcial</li>
                        <li>Ingresa el monto del abono que el cliente está realizando, selecciona el medio de pago correspondiente y haz clic en <strong>Causar y pagar</strong> para confirmar el registro</li>
                    </ol>
                </div>
            </div>

        </section>

        <!-- Segunda Sección: Facturar Plan Separe -->
        <section class="section animate-in">
            <h2>
                <i class="fas fa-receipt"></i>
                Facturar el Plan Separe Completo
            </h2>
            <p style="margin-bottom: var(--spacing-xl); color: var(--text-secondary); font-size: var(--font-size-lg);">
                Una vez que el cliente ha completado todos los abonos, convierte el plan separe en una factura definitiva para formalizar la venta.
            </p>
            
            <div class="alert alert-success">
                <i class="fas fa-stopwatch"></i>
                <div>
                    <strong>Tiempo estimado de operación:</strong>
                    <p>Aproximadamente 1:30 minutos para completar el proceso de facturación final.</p>
                </div>
            </div>
            
            <!-- Contenedor responsivo del video -->
            <div class="responsive-video-wrapper">
                <div class="video-container">
                    <!-- Video optimizado para máxima compatibilidad iOS Safari -->
                    <video id="videoPlayer2" 
                           class="video-player"
                           controls
                           preload="metadata"
                           playsinline
                           webkit-playsinline
                           muted
                           disablePictureInPicture>
                        <source src="../../assets/videos/Facturas/abonar-facturar-plan-separe/facturar-plan-separe.mp4" type="video/mp4">
                        <p>Tu navegador no soporta la reproducción de video HTML5. 
                           <a href="../../assets/videos/Facturas/abonar-facturar-plan-separe/facturar-plan-separe.mp4" target="_blank">
                              Haz clic aquí para descargar el video
                           </a>
                        </p>
                    </video>
                    
                    <!-- Poster de carga personalizado -->
                    <div class="video-poster" id="videoPoster2">
                        <div class="poster-content">
                            <i class="fas fa-play-circle"></i>
                            <h4>Video Tutorial: Facturar Plan Separe</h4>
                            <p>Toca para reproducir</p>
                        </div>
                    </div>
                </div>
                
                <!-- Fallback para errores (fuera del video) -->
                <div class="video-fallback" id="videoFallback2" style="display: none;">
                    <div class="fallback-content">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h4>Video no disponible</h4>
                        <p>Verifica tu conexión a internet o contacta con soporte técnico.</p>
                        <button class="retry-btn" onclick="VideoHandler.retryLoad(2)">
                            <i class="fas fa-redo"></i> Reintentar
                        </button>
                    </div>
                </div>
            </div>

            <!-- Paso a Paso dentro de la sección del video -->
            <div class="alert alert-info" role="alert" style="margin-top: var(--spacing-xl);">
                <i class="fas fa-list-ol" aria-hidden="true"></i>
                <div>
                    <strong>Paso a Paso - Facturar el Plan Separe Completo:</strong>
                    <ol style="margin-top: var(--spacing-sm); padding-left: var(--spacing-lg);">
                        <li>Registra el abono final por el saldo pendiente y asegúrate de activar la casilla <strong>Facturar</strong> para indicar que se generará la factura definitiva</li>
                        <li>Selecciona el medio de pago para el abono final y haz clic en <strong>Causar y pagar</strong>. El sistema generará automáticamente la factura y completará el proceso</li>
                    </ol>
                </div>
            </div>

        </section>

        <!-- Consejos Importantes -->
        <div class="alert alert-warning">
            <i class="fas fa-lightbulb"></i>
            <div>
                <strong>Consejo Importante</strong>
                <p>Si el botón "Facturar" no aparece disponible, verifica que el saldo esté completamente en cero. Puedes consultar el saldo pendiente en la parte superior de la vista de detalle del plan separe.</p>
            </div>
        </div>

        <!-- Ejercicio Sugerido -->
        <div class="alert alert-success">
            <i class="fas fa-tasks"></i>
            <div>
                <strong>Ejercicio Práctico Sugerido</strong>
                <p>Simula un caso real: crea un plan separe, realiza 2-3 abonos parciales en diferentes fechas, y luego completa el proceso con la facturación final cuando el saldo llegue a cero.</p>
            </div>
        </div>

        <!-- Footer de Navegación del Curso -->
        <footer class="course-footer animate-in">
            <div class="course-footer-content">
                <h3>
                    <i class="fas fa-route"></i>
                    Navegación del Curso
                </h3>
                
                <!-- Indicador de Progreso -->
                <div class="progress-indicator">
                    <div class="progress-dot completed" title="Introducción a facturas"></div>
                    <div class="progress-dot completed" title="Factura de venta"></div>
                    <div class="progress-dot completed" title="Crear Plan Separe"></div>
                    <div class="progress-dot completed" title="Consultar plan separe"></div>
                    <div class="progress-dot current" title="Abonar y facturar plan separe - Módulo Actual"></div>
                </div>

                <!-- Navegación Principal -->
                <nav class="course-navigation">
                    <a href="consultar-plan-separe.html" class="nav-item prev">
                        <div class="nav-btn prev">
                            <i class="fas fa-arrow-left"></i>
                            <div>
                                <div style="font-size: 0.75rem; color: var(--neutral-500);">Anterior</div>
                                <div>Consultar Plan Separe</div>
                            </div>
                        </div>
                    </a>
                    <a href="../../index.html" class="nav-item home">
                        <div class="nav-btn home">
                            <i class="fas fa-home"></i>
                            <div>
                                <div style="font-size: 0.75rem; color: var(--neutral-500);">Curso</div>
                                <div>Inicio</div>
                            </div>
                        </div>
                    </a>
                    <a href="fin-modulo-facturas.html" class="nav-item next">
                        <div class="nav-btn next">
                            <div>
                                <div style="font-size: 0.75rem; color: var(--neutral-500);">Siguiente</div>
                                <div>Fin del módulo: Gestión de Facturas</div>
                            </div>
                            <i class="fas fa-arrow-right"></i>
                        </div>
                    </a>
                </nav>

                <!-- Información del Módulo -->
                <div class="nav-info">
                    <p>
                        <strong>Módulo Facturas:</strong> Abonar y Facturar Plan Separe | 
                        <strong>Anterior:</strong> Consultar plan separe | 
                        <strong>Siguiente:</strong> Fin del módulo: Gestión de Facturas
                    </p>
                    <p style="margin-top: var(--spacing-sm); font-size: 0.8rem;">
                        <i class="fas fa-graduation-cap"></i>
                        Curso Sinnut ERP - OroExpress s.a.s
                    </p>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // Sistema de Gestión del Módulo
        const AbonarFacturarModule = {
            init() {
                this.setupAnimations();
                this.setupInteractions();
                this.setupVideoTracking();
                this.setupNavigationEffects();
                this.initializeProgressTracking();
                console.log('🚀 Módulo Abonar y Facturar Plan Separe inicializado');
            },

            // Sistema de animaciones progresivas
            setupAnimations() {
                const observerOptions = {
                    threshold: 0.1,
                    rootMargin: '0px 0px -50px 0px'
                };

                const observer = new IntersectionObserver((entries) => {
                    entries.forEach((entry, index) => {
                        if (entry.isIntersecting) {
                            setTimeout(() => {
                                entry.target.classList.add('animate-in');
                                entry.target.style.opacity = '1';
                                entry.target.style.transform = 'translateY(0)';
                            }, index * 150);
                        }
                    });
                }, observerOptions);

                // Animar elementos progresivamente
                document.querySelectorAll('.section').forEach((el, index) => {
                    el.style.opacity = '0';
                    el.style.transform = 'translateY(30px)';
                    el.style.transition = 'all 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
                    observer.observe(el);
                });

                document.querySelectorAll('.step').forEach((el, index) => {
                    el.style.opacity = '0';
                    el.style.transform = 'scale(0.95)';
                    el.style.transition = 'all 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
                    setTimeout(() => observer.observe(el), index * 100);
                });

                document.querySelectorAll('.alert').forEach((el, index) => {
                    el.style.opacity = '0';
                    el.style.transform = 'translateX(-20px)';
                    el.style.transition = 'all 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
                    setTimeout(() => observer.observe(el), index * 200);
                });
            },

            // Configurar interacciones mejoradas
            setupInteractions() {
                // Efectos hover avanzados para steps
                document.querySelectorAll('.step').forEach(step => {
                    step.addEventListener('mouseenter', (e) => {
                        this.createStepHoverEffect(e.currentTarget);
                    });
                    
                    step.addEventListener('mouseleave', (e) => {
                        e.currentTarget.style.transform = 'translateY(0) scale(1)';
                    });
                });

                // Efectos ripple para botones
                document.querySelectorAll('.btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.createRippleEffect(e);
                    });
                });

                // Navegación sticky mejorada
                this.setupStickyNavigation();
            },

            // Efecto hover para steps
            createStepHoverEffect(step) {
                step.style.transform = 'translateY(-8px) scale(1.02)';
                step.style.transition = 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)';

                const stepNumber = step.querySelector('.step-number');
                if (stepNumber) {
                    stepNumber.style.transform = 'scale(1.1) rotate(5deg)';
                    stepNumber.style.transition = 'all 0.3s ease';
                }
            },

            // Efecto ripple para botones
            createRippleEffect(e) {
                const button = e.currentTarget;
                const rect = button.getBoundingClientRect();
                const ripple = document.createElement('span');
                const size = Math.max(rect.width, rect.height);
                const x = e.clientX - rect.left - size / 2;
                const y = e.clientY - rect.top - size / 2;

                ripple.style.cssText = `
                    position: absolute;
                    width: ${size}px;
                    height: ${size}px;
                    left: ${x}px;
                    top: ${y}px;
                    border-radius: 50%;
                    background: rgba(255,255,255,0.6);
                    transform: scale(0);
                    animation: ripple 0.6s ease-out;
                    pointer-events: none;
                    z-index: 1000;
                `;

                button.style.position = 'relative';
                button.style.overflow = 'hidden';
                button.appendChild(ripple);

                setTimeout(() => ripple.remove(), 600);
            },

            // Configurar tracking de videos
            setupVideoTracking() {
                const videos = document.querySelectorAll('video');
                const videoTitles = [
                    'Abonar a un plan separe',
                    'Facturar plan separe'
                ];

                videos.forEach((video, index) => {
                    let hasStarted = false;
                    let hasCompleted = false;

                    video.addEventListener('play', () => {
                        if (!hasStarted) {
                            hasStarted = true;
                            this.trackVideoEvent('started', videoTitles[index], index + 1);
                            console.log(`📹 Video ${index + 1} iniciado: ${videoTitles[index]}`);
                        }
                    });

                    video.addEventListener('ended', () => {
                        if (!hasCompleted) {
                            hasCompleted = true;
                            this.trackVideoEvent('completed', videoTitles[index], index + 1);
                            console.log(`✅ Video ${index + 1} completado: ${videoTitles[index]}`);
                        }
                    });

                    // Tracking de progreso del video
                    video.addEventListener('timeupdate', () => {
                        const progress = (video.currentTime / video.duration) * 100;
                        if (progress >= 50 && !video.dataset.halfwayTracked) {
                            video.dataset.halfwayTracked = 'true';
                            this.trackVideoEvent('halfway', videoTitles[index], index + 1);
                        }
                    });
                });
            },

            // Tracking de eventos de video
            trackVideoEvent(event, title, videoNumber) {
                const eventData = {
                    moduleId: 'abonar-facturar-plan-separe',
                    moduleName: 'Abonar y Facturar Plan Separe',
                    videoTitle: title,
                    videoNumber: videoNumber,
                    event: event,
                    timestamp: new Date().toISOString()
                };

                // Guardar en localStorage
                const existingData = JSON.parse(localStorage.getItem('video_progress') || '[]');
                existingData.push(eventData);
                localStorage.setItem('video_progress', JSON.stringify(existingData));

                // Enviar a sistema de tracking si está disponible
                if (typeof SinnutTraining !== 'undefined') {
                    SinnutTraining.trackEvent(`video_${event}`, eventData);
                }
            },

            // Configurar navegación sticky
            setupStickyNavigation() {
                const navBreadcrumb = document.getElementById('navBreadcrumb');
                let lastScrollY = window.scrollY;

                function handleScroll() {
                    const currentScrollY = window.scrollY;
                    const isScrolled = currentScrollY > 100;

                    navBreadcrumb.classList.toggle('scrolled', isScrolled);

                    // Efecto de dirección de scroll
                    if (currentScrollY > lastScrollY && currentScrollY > 200) {
                        navBreadcrumb.style.transform = 'translateY(-100%)';
                    } else {
                        navBreadcrumb.style.transform = 'translateY(0)';
                    }

                    lastScrollY = currentScrollY;
                }

                // Throttle para mejor performance
                let scrollTimeout;
                window.addEventListener('scroll', () => {
                    if (scrollTimeout) {
                        clearTimeout(scrollTimeout);
                    }
                    scrollTimeout = setTimeout(handleScroll, 10);
                });

                handleScroll(); // Check initial state
            },

            // Configurar efectos de navegación
            setupNavigationEffects() {
                // Animación de entrada del footer
                this.animateCourseFooter();

                // Efectos hover para navegación
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.addEventListener('mouseenter', (e) => {
                        this.createNavigationHoverEffect(e.currentTarget);
                    });

                    btn.addEventListener('mouseleave', (e) => {
                        e.currentTarget.style.transform = 'translateY(0) scale(1)';
                    });
                });

                // Atajos de teclado
                this.setupKeyboardShortcuts();
            },

            // Efecto hover para navegación
            createNavigationHoverEffect(element) {
                element.style.transform = 'translateY(-4px) scale(1.05)';
                element.style.transition = 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)';

                // Agregar efecto de brillo
                const highlight = document.createElement('div');
                highlight.style.cssText = `
                    position: absolute;
                    top: 0;
                    left: -100%;
                    width: 100%;
                    height: 100%;
                    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
                    transition: left 0.5s ease;
                    pointer-events: none;
                    z-index: 1;
                `;

                element.style.position = 'relative';
                element.style.overflow = 'hidden';
                element.appendChild(highlight);

                setTimeout(() => {
                    highlight.style.left = '100%';
                }, 50);

                setTimeout(() => highlight.remove(), 600);
            },

            // Configurar atajos de teclado
            setupKeyboardShortcuts() {
                document.addEventListener('keydown', (e) => {
                    if (e.ctrlKey || e.metaKey) {
                        switch(e.key) {
                            case 'ArrowLeft':
                                e.preventDefault();
                                this.navigateTo('consultar-plan-separe.html');
                                break;
                            case 'ArrowRight':
                                e.preventDefault();
                                this.navigateTo('fin-modulo-facturas.html');
                                break;
                            case 'Home':
                                e.preventDefault();
                                this.navigateTo('../../index.html');
                                break;
                        }
                    }
                });
            },

            // Navegar con transición
            navigateTo(url) {
                const overlay = document.createElement('div');
                overlay.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100vw;
                    height: 100vh;
                    background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
                    z-index: 10000;
                    opacity: 0;
                    transition: opacity 0.3s ease;
                    pointer-events: none;
                `;

                document.body.appendChild(overlay);

                setTimeout(() => {
                    overlay.style.opacity = '1';
                    setTimeout(() => {
                        window.location.href = url;
                    }, 150);
                }, 50);
            },

            // Animar footer del curso
            animateCourseFooter() {
                const footer = document.querySelector('.course-footer');
                if (!footer) return;

                footer.style.opacity = '0';
                footer.style.transform = 'translateY(50px)';

                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            setTimeout(() => {
                                footer.style.transition = 'all 0.8s cubic-bezier(0.4, 0, 0.2, 1)';
                                footer.style.opacity = '1';
                                footer.style.transform = 'translateY(0)';
                                this.animateProgressDots();
                            }, 300);
                            observer.unobserve(entry.target);
                        }
                    });
                });

                observer.observe(footer);
            },

            // Animar indicadores de progreso
            animateProgressDots() {
                const dots = document.querySelectorAll('.progress-dot');
                dots.forEach((dot, index) => {
                    setTimeout(() => {
                        dot.style.transform = 'scale(1.4)';
                        setTimeout(() => {
                            dot.style.transform = dot.classList.contains('current') ? 'scale(1.3)' : 'scale(1)';
                        }, 200);
                    }, index * 150);
                });
            },

            // Inicializar tracking de progreso
            initializeProgressTracking() {
                this.startTime = Date.now();
                this.hasScrolledToBottom = false;
                this.completedSections = new Set();

                // Tracking de scroll
                this.setupScrollTracking();

                // Tracking de tiempo en página
                this.setupTimeTracking();

                // Tracking inicial
                this.trackModuleStart();
            },

            // Configurar tracking de scroll
            setupScrollTracking() {
                let scrollTimeout;
                window.addEventListener('scroll', () => {
                    if (scrollTimeout) clearTimeout(scrollTimeout);
                    
                    scrollTimeout = setTimeout(() => {
                        const scrolled = window.scrollY;
                        const maxScroll = document.documentElement.scrollHeight - window.innerHeight;
                        const scrollPercentage = (scrolled / maxScroll) * 100;

                        if (scrollPercentage > 80 && !this.hasScrolledToBottom) {
                            this.hasScrolledToBottom = true;
                            this.trackEvent('content_completed', {
                                scrollPercentage: Math.round(scrollPercentage),
                                timeSpent: Date.now() - this.startTime
                            });
                        }

                        // Tracking de secciones visibles
                        this.checkVisibleSections();
                    }, 100);
                });
            },

            // Verificar secciones visibles
            checkVisibleSections() {
                document.querySelectorAll('.section').forEach((section, index) => {
                    const rect = section.getBoundingClientRect();
                    const isVisible = rect.top < window.innerHeight && rect.bottom > 0;
                    
                    if (isVisible && !this.completedSections.has(index)) {
                        this.completedSections.add(index);
                        this.trackEvent('section_viewed', {
                            sectionIndex: index,
                            sectionTitle: section.querySelector('h2')?.textContent?.trim() || `Sección ${index + 1}`
                        });
                    }
                });
            },

            // Configurar tracking de tiempo
            setupTimeTracking() {
                // Guardar progreso antes de salir
                window.addEventListener('beforeunload', () => {
                    const timeSpent = Date.now() - this.startTime;
                    this.trackEvent('session_ended', {
                        timeSpent: timeSpent,
                        hasScrolledToBottom: this.hasScrolledToBottom,
                        sectionsViewed: this.completedSections.size
                    });
                });

                // Tracking periódico cada 30 segundos
                setInterval(() => {
                    this.trackEvent('heartbeat', {
                        timeSpent: Date.now() - this.startTime,
                        currentScroll: window.scrollY
                    });
                }, 30000);
            },

            // Tracking de inicio del módulo
            trackModuleStart() {
                this.trackEvent('module_started', {
                    moduleId: 'abonar-facturar-plan-separe',
                    moduleName: 'Abonar y Facturar Plan Separe',
                    timestamp: new Date().toISOString(),
                    userAgent: navigator.userAgent,
                    viewport: {
                        width: window.innerWidth,
                        height: window.innerHeight
                    }
                });
            },

            // Función general de tracking
            trackEvent(eventType, data) {
                const eventData = {
                    eventType: eventType,
                    moduleId: 'abonar-facturar-plan-separe',
                    timestamp: new Date().toISOString(),
                    ...data
                };

                // Guardar en localStorage
                const events = JSON.parse(localStorage.getItem('module_events') || '[]');
                events.push(eventData);
                localStorage.setItem('module_events', JSON.stringify(events.slice(-100))); // Mantener últimos 100 eventos

                // Enviar a sistema externo si está disponible
                if (typeof SinnutTraining !== 'undefined') {
                    SinnutTraining.trackEvent(eventType, eventData);
                }

                console.log(`📊 Event tracked: ${eventType}`, eventData);
            }
        };

        // CSS adicional para animaciones
        const additionalCSS = `
            @keyframes ripple {
                to { transform: scale(4); opacity: 0; }
            }
            
            @keyframes confetti {
                0% { transform: translateY(0) rotateZ(0deg); opacity: 1; }
                100% { transform: translateY(100vh) rotateZ(720deg); opacity: 0; }
            }
        `;

        // Inyectar CSS adicional
        const style = document.createElement('style');
        style.textContent = additionalCSS;
        document.head.appendChild(style);

        // Inicializar módulo cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', () => {
            AbonarFacturarModule.init();
        });

        // Smooth scroll para enlaces internos
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
    <!-- Script para mejorar compatibilidad de videos en móviles -->
    <script src="../../fix-mobile-videos.js"></script>

    <!-- iOS Safari Video Fix - Solución específica para reproducción de videos en móviles -->
    <script src="../../ios-video-fix.js"></script>
    
    <!-- VideoHandler para gestión avanzada de videos múltiples -->
    <script>
        const VideoHandler = {
            videos: [],
            posters: [],
            fallbacks: [],
            
            init() {
                // Inicializar arrays para múltiples videos
                this.videos = [
                    document.getElementById('videoPlayer1'),
                    document.getElementById('videoPlayer2')
                ];
                this.posters = [
                    document.getElementById('videoPoster1'),
                    document.getElementById('videoPoster2')
                ];
                this.fallbacks = [
                    document.getElementById('videoFallback1'),
                    document.getElementById('videoFallback2')
                ];
                
                // Configurar cada video
                this.videos.forEach((video, index) => {
                    if (video && this.posters[index]) {
                        this.setupVideoEvents(video, index);
                        this.checkVideoLoad(video, index);
                    }
                });
                
                console.log('🎬 VideoHandler inicializado para Abonar y Facturar Plan Separe');
            },
            
            setupVideoEvents(video, index) {
                const poster = this.posters[index];
                const fallback = this.fallbacks[index];
                
                // Click en el poster para reproducir
                poster.addEventListener('click', () => this.playVideo(index));
                
                // Eventos del video
                video.addEventListener('play', () => this.onPlay(index));
                video.addEventListener('pause', () => this.onPause(index));
                video.addEventListener('ended', () => this.onEnded(index));
                video.addEventListener('error', () => this.onError(index));
                video.addEventListener('loadeddata', () => this.onLoaded(index));
                
                // Touch events para móviles
                poster.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    this.playVideo(index);
                });
            },
            
            checkVideoLoad(video, index) {
                // Verificar si el video se carga correctamente
                setTimeout(() => {
                    if (video.readyState === 0) {
                        this.showFallback(index);
                    }
                }, 5000);
            },
            
            playVideo(index) {
                const video = this.videos[index];
                if (video) {
                    // Ocultar poster
                    this.posters[index].style.display = 'none';
                    
                    // Reproducir video
                    const playPromise = video.play();
                    
                    if (playPromise !== undefined) {
                        playPromise.then(() => {
                            console.log(`🎬 Video ${index + 1} reproduciéndose`);
                        }).catch(error => {
                            console.warn(`⚠️ Error al reproducir video ${index + 1}:`, error);
                            this.showFallback(index);
                        });
                    }
                }
            },
            
            onPlay(index) {
                this.posters[index].style.display = 'none';
                this.fallbacks[index].style.display = 'none';
                
                // Tracking
                if (typeof SinnutTraining !== 'undefined') {
                    const titles = ['Registrar Abonos', 'Facturar Plan Separe'];
                    SinnutTraining.trackEvent('video_started', {
                        moduleId: 'abonar-facturar-plan-separe',
                        videoTitle: titles[index],
                        videoNumber: index + 1
                    });
                }
            },
            
            onPause(index) {
                // Mostrar poster si el video está pausado al inicio
                const video = this.videos[index];
                if (video.currentTime < 1) {
                    this.posters[index].style.display = 'flex';
                }
            },
            
            onEnded(index) {
                // Mostrar poster al finalizar
                this.posters[index].style.display = 'flex';
                
                // Tracking
                if (typeof SinnutTraining !== 'undefined') {
                    const titles = ['Registrar Abonos', 'Facturar Plan Separe'];
                    SinnutTraining.trackEvent('video_completed', {
                        moduleId: 'abonar-facturar-plan-separe',
                        videoTitle: titles[index],
                        videoNumber: index + 1
                    });
                }
                
                // Mostrar notificación de completado
                this.showCompletionNotification(index);
            },
            
            onError(index) {
                console.error(`❌ Error al cargar el video ${index + 1}`);
                this.showFallback(index);
            },
            
            onLoaded(index) {
                console.log(`✅ Video ${index + 1} cargado correctamente`);
                this.fallbacks[index].style.display = 'none';
            },
            
            showFallback(index) {
                if (this.fallbacks[index]) {
                    this.fallbacks[index].style.display = 'flex';
                    this.posters[index].style.display = 'none';
                }
            },
            
            retryLoad(index) {
                const video = this.videos[index];
                if (video) {
                    video.load();
                    this.fallbacks[index].style.display = 'none';
                    this.posters[index].style.display = 'flex';
                    
                    setTimeout(() => {
                        if (video.readyState === 0) {
                            this.showFallback(index);
                        }
                    }, 3000);
                }
            },
            
            showCompletionNotification(index) {
                const titles = ['Registrar Abonos', 'Facturar Plan Separe'];
                
                // Crear notificación de completado
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: linear-gradient(135deg, var(--success-color), #4ade80);
                    color: white;
                    padding: var(--spacing-md);
                    border-radius: var(--radius-lg);
                    box-shadow: 0 10px 25px rgba(0,0,0,0.2);
                    z-index: 1000;
                    font-weight: 600;
                    animation: slideInRight 0.5s ease-out;
                    max-width: 300px;
                `;
                
                notification.innerHTML = `
                    <i class="fas fa-check-circle" style="margin-right: var(--spacing-sm);"></i>
                    ¡Video completado! ${titles[index]}
                `;
                
                document.body.appendChild(notification);
                
                // Auto-remover después de 5 segundos
                setTimeout(() => {
                    notification.style.animation = 'slideOutRight 0.5s ease-out';
                    setTimeout(() => notification.remove(), 500);
                }, 5000);
            }
        };
        
        // Inicializar VideoHandler cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', () => {
            VideoHandler.init();
        });
    </script>
</body>
</html>






