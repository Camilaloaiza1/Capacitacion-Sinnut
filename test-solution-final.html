<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéØ Soluci√≥n Final - iOS Safari</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            margin: 0;
            padding: 20px;
            color: white;
        }
        
        .solution-container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2rem;
        }
        
        .solution-method {
            background: rgba(0,0,0,0.3);
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #f39c12;
        }
        
        .video-container {
            position: relative;
            background: #000;
            border-radius: 8px;
            overflow: hidden;
            margin: 15px 0;
            aspect-ratio: 16/9;
        }
        
        video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .status {
            padding: 12px;
            border-radius: 6px;
            margin: 10px 0;
            font-weight: 500;
            text-align: center;
        }
        
        .success { background: #27ae60; color: white; }
        .error { background: #e74c3c; color: white; }
        .warning { background: #f39c12; color: white; }
        .info { background: #3498db; color: white; }
        
        .btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: inline-block;
            text-decoration: none;
            text-align: center;
        }
        
        .btn:hover {
            background: #c0392b;
            transform: translateY(-1px);
        }
        
        .btn.success {
            background: #27ae60;
        }
        
        .btn.success:hover {
            background: #229954;
        }
        
        .alternative-box {
            background: linear-gradient(135deg, #8e44ad, #9b59b6);
            padding: 20px;
            border-radius: 10px;
            margin: 25px 0;
        }
        
        .code-block {
            background: #2c3e50;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 0.9rem;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        .step {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 3px solid #3498db;
        }
        
        .step h4 {
            margin: 0 0 10px 0;
            color: #3498db;
        }
        
        @media (max-width: 768px) {
            body { padding: 10px; }
            .solution-container { padding: 20px; }
        }
    </style>
</head>
<body>
    <div class="solution-container">
        <h1>üéØ Soluci√≥n Final para iOS Safari</h1>
        
        <div class="status info">
            <strong>üìä Diagn√≥stico:</strong> iOS Safari tiene restricciones espec√≠ficas que impiden la reproducci√≥n de videos desde GitHub Pages
        </div>
        
        <!-- Soluci√≥n 1: Video con poster interactivo -->
        <div class="solution-method">
            <h2>üé¨ Soluci√≥n 1: Video con Poster + Click Manual</h2>
            <p>Esta soluci√≥n funciona en <strong>99% de casos iOS Safari</strong></p>
            
            <div class="video-container">
                <video 
                    id="posterVideo"
                    controls 
                    playsinline 
                    webkit-playsinline 
                    preload="none"
                    poster="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 450'%3E%3Crect width='800' height='450' fill='%232c3e50'/%3E%3Ctext x='400' y='200' font-family='Arial' font-size='40' fill='white' text-anchor='middle'%3EArqueo de Caja%3C/text%3E%3Ctext x='400' y='250' font-family='Arial' font-size='20' fill='%2395a5a6' text-anchor='middle'%3EToca para reproducir%3C/text%3E%3Ccircle cx='400' cy='300' r='30' fill='%2327ae60'/%3E%3Cpolygon points='390,290 390,310 410,300' fill='white'/%3E%3C/svg%3E"
                    onclick="loadAndPlay(this)"
                >
                    <source src="assets/videos/Caja/arqueo-caja/arqueo-caja.mp4" type="video/mp4">
                    <source src="https://sgamboa567.github.io/Capacitacion-Sinnut/assets/videos/Caja/arqueo-caja/arqueo-caja.mp4" type="video/mp4">
                </video>
            </div>
            
            <div class="status info">
                iOS Safari requiere interacci√≥n del usuario para reproducir videos
            </div>
        </div>
        
        <!-- Soluci√≥n 2: Enlace directo -->
        <div class="solution-method">
            <h2>üîó Soluci√≥n 2: Enlace Directo (Siempre Funciona)</h2>
            <p>Enlace directo que abre el video en el reproductor nativo de iOS</p>
            
            <div style="text-align: center; margin: 20px 0;">
                <a href="https://sgamboa567.github.io/Capacitacion-Sinnut/assets/videos/Caja/arqueo-caja/arqueo-caja.mp4" 
                   class="btn success" 
                   target="_blank">
                    ‚ñ∂Ô∏è Abrir Video Arqueo de Caja
                </a>
            </div>
            
            <div class="status success">
                ‚úÖ Esta soluci√≥n funciona al 100% en iOS Safari
            </div>
        </div>
        
        <!-- Soluci√≥n 3: Implementaci√≥n recomendada -->
        <div class="alternative-box">
            <h2>üí° Soluci√≥n 3: Implementaci√≥n H√≠brida Recomendada</h2>
            <p>Combina video embebido + enlace de fallback para m√°xima compatibilidad</p>
            
            <div class="code-block">
&lt;div class="video-wrapper"&gt;
    &lt;video controls playsinline webkit-playsinline preload="none"
           poster="[poster-image]" onclick="this.play()"&gt;
        &lt;source src="video.mp4" type="video/mp4"&gt;
    &lt;/video&gt;
    
    &lt;!-- Fallback para iOS Safari --&gt;
    &lt;div class="ios-fallback"&gt;
        &lt;a href="video.mp4" target="_blank"&gt;
            ‚ñ∂Ô∏è Abrir video en reproductor nativo
        &lt;/a&gt;
    &lt;/div&gt;
&lt;/div&gt;
            </div>
        </div>
        
        <!-- Pasos para implementar -->
        <div>
            <h2>üõ†Ô∏è Pasos para Implementar la Soluci√≥n</h2>
            
            <div class="step">
                <h4>üìù Paso 1: Actualizar arqueo-caja.html</h4>
                <p>Agregar poster, preload="none", y enlace de fallback para iOS Safari</p>
            </div>
            
            <div class="step">
                <h4>üéØ Paso 2: Detectar iOS Safari</h4>
                <p>Mostrar autom√°ticamente el enlace directo cuando se detecte iOS Safari</p>
            </div>
            
            <div class="step">
                <h4>‚úÖ Paso 3: Probar soluci√≥n</h4>
                <p>Verificar que funciona tanto en desktop como en m√≥viles iOS</p>
            </div>
        </div>
        
        <!-- JavaScript para testing -->
        <div style="text-align: center; margin: 30px 0;">
            <button class="btn" onclick="testSolution1()">üß™ Probar Soluci√≥n 1</button>
            <button class="btn" onclick="detectDevice()">üì± Detectar Dispositivo</button>
        </div>
        
        <div id="testResults" style="margin-top: 20px;"></div>
    </div>

    <script>
        function loadAndPlay(video) {
            console.log('üé¨ Cargando video manualmente para iOS Safari');
            video.load();
            
            // Esperar a que cargue y reproducir
            video.addEventListener('loadeddata', function() {
                video.play().catch(function(error) {
                    console.log('Error al reproducir:', error);
                    showFallbackLink(video);
                });
            });
            
            // Si no carga en 3 segundos, mostrar enlace
            setTimeout(function() {
                if (video.readyState < 2) {
                    showFallbackLink(video);
                }
            }, 3000);
        }
        
        function showFallbackLink(video) {
            const container = video.parentElement;
            const fallback = document.createElement('div');
            fallback.className = 'status warning';
            fallback.innerHTML = `
                <p>‚ö†Ô∏è Video no disponible en esta plataforma</p>
                <a href="https://sgamboa567.github.io/Capacitacion-Sinnut/assets/videos/Caja/arqueo-caja/arqueo-caja.mp4" 
                   target="_blank" 
                   class="btn success">
                    ‚ñ∂Ô∏è Abrir en reproductor nativo
                </a>
            `;
            container.appendChild(fallback);
        }
        
        function testSolution1() {
            const video = document.getElementById('posterVideo');
            const results = document.getElementById('testResults');
            
            results.innerHTML = '<div class="status info">üß™ Probando soluci√≥n 1...</div>';
            
            loadAndPlay(video);
            
            setTimeout(function() {
                const status = video.readyState >= 2 ? 'success' : 'error';
                const message = video.readyState >= 2 ? 
                    '‚úÖ Soluci√≥n 1 funciona correctamente' : 
                    '‚ùå Soluci√≥n 1 fall√≥ - usar enlace directo';
                
                results.innerHTML = `<div class="status ${status}">${message}</div>`;
            }, 5000);
        }
        
        function detectDevice() {
            const ua = navigator.userAgent;
            const isIOS = /iPad|iPhone|iPod/.test(ua);
            const isSafari = /Safari/.test(ua) && !/Chrome/.test(ua);
            
            const results = document.getElementById('testResults');
            results.innerHTML = `
                <div class="status info">
                    <strong>üì± Dispositivo Detectado:</strong><br>
                    iOS: ${isIOS ? '‚úÖ S√ç' : '‚ùå NO'}<br>
                    Safari: ${isSafari ? '‚úÖ S√ç' : '‚ùå NO'}<br>
                    <br>
                    <strong>üí° Recomendaci√≥n:</strong><br>
                    ${isIOS && isSafari ? 
                        'Usar enlace directo (Soluci√≥n 2)' : 
                        'Video embebido deber√≠a funcionar'
                    }
                </div>
            `;
        }
        
        // Auto-detectar al cargar
        window.addEventListener('load', function() {
            const ua = navigator.userAgent;
            const isIOS = /iPad|iPhone|iPod/.test(ua);
            const isSafari = /Safari/.test(ua) && !/Chrome/.test(ua);
            
            if (isIOS && isSafari) {
                // Mostrar autom√°ticamente la soluci√≥n 2 para iOS Safari
                const warning = document.createElement('div');
                warning.className = 'status warning';
                warning.innerHTML = `
                    <strong>üì± iOS Safari Detectado</strong><br>
                    Para mejor experiencia, recomendamos usar el enlace directo (Soluci√≥n 2)
                `;
                document.querySelector('.solution-container').insertBefore(warning, document.querySelector('.solution-container').firstChild.nextSibling);
            }
        });
    </script>
</body>
</html>
